<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8"/>
  <title>Reservation — ROESTILAND BY NOXAMA SAMUI</title>
  <link rel="stylesheet" href="/style.css"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    /* minimale Modal Styles, harmonisch zum Design */
    .nox-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(10,10,10,0.55);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20000;
      backdrop-filter: blur(4px);
    }
    .nox-modal {
      width: min(920px, 94%);
      max-width: 920px;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 30px 60px rgba(0,0,0,0.45);
      background: linear-gradient(180deg, #fffaf6 0%, #fff3e8 100%);
      border: 1px solid rgba(200,170,130,0.18);
      position: relative;
      font-family: Georgia, serif;
      color: #3a2f28;
    }
    .nox-modal .modal-body {
      padding: 22px;
      text-align: center;
      position: relative;
    }
    .nox-modal h2 {
      margin: 4px 0 8px 0;
      font-size: 28px;
      font-weight: 600;
    }
    .nox-modal .sub {
      color: #5b4b3b;
      margin-bottom: 14px;
    }
    .nox-modal .cta {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 8px;
      background: #b3822f;
      color: white;
      font-weight: 600;
      border: none;
      cursor: pointer;
      margin-top: 12px;
    }
    .nox-modal .small-note {
      margin-top: 8px;
      color: #6a5b4f;
      font-size: 13px;
    }

    /* canvas container */
    .nox-fireworks {
      width: 100%;
      height: 260px;
      background: radial-gradient(circle at 10% 10%, rgba(255,243,230,0.3), transparent 10%),
                  linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.01));
      position: relative;
      overflow: hidden;
    }

    /* decorative panel behind text */
    .nox-reward-panel {
      display: inline-block;
      background: linear-gradient(180deg,#fff6ea,#fff0db);
      border-radius: 10px;
      padding: 12px 18px;
      border: 1px solid rgba(214,187,147,0.6);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
      margin-top: 8px;
    }

    .nox-modal .close-x {
      position: absolute;
      right: 10px;
      top: 10px;
      background: rgba(0,0,0,0.06);
      border-radius: 8px;
      padding: 6px 8px;
      cursor: pointer;
      border: none;
    }

    /* responsive tweak */
    @media (max-width:520px){
      .nox-fireworks{height:180px;}
      .nox-modal h2{font-size:20px;}
    }
  </style>
</head>
<body>
  <div class="hero-wrap" style="text-align:center;margin-top:18px;">
    <img id="heroBanner" class="hero-banner"
         alt="Logo banner"
         style="max-width:640px;width:76%;border-radius:12px;box-shadow:0 25px 50px rgba(0,0,0,.18);" />
  </div>

  <!-- dein existierendes Form bleibt unveraendert, nehme an du hast es bereits -->
  <!-- ... (dein Reservation Formular hier unveraendert) ... -->
  <!-- fuer Platzsparsamkeit habe ich markup weggelassen, das bleibt wie bei dir -->

<script>
  // Utility minimal um Modal zu erzeugen
  function createLoyaltyModal(tier, visitNo){
    // remove existing
    const ex = document.getElementById("__nox_loyalty");
    if (ex) ex.remove();

    // overlay
    const overlay = document.createElement("div");
    overlay.id = "__nox_loyalty";
    overlay.className = "nox-modal-overlay";

    // modal container
    const modal = document.createElement("div");
    modal.className = "nox-modal";
    modal.innerHTML = `
      <button class="close-x" aria-label="close">✕</button>
      <div class="nox-fireworks" id="__nox_fireworks_canvas_wrap"></div>
      <div class="modal-body">
        <h2>You earned a loyalty reward</h2>
        <div class="sub">Congratulations — loyalty reward unlocked</div>
        <div style="font-size:15px;color:#4b3b2f;margin-bottom:8px;">You just reached visit ${visitNo}</div>
        <div class="nox-reward-panel">
          <div style="font-size:20px;"><strong>Enjoy a ${tier}% thank-you discount on your next visit</strong></div>
        </div>
        <div class="small-note">We applied a note to your profile. Thank you for your loyalty.</div>
        <div style="margin-top:14px;">
          <button class="cta" id="__nox_ok_btn">Okay</button>
        </div>
      </div>
    `;

    overlay.appendChild(modal);
    document.body.appendChild(overlay);

    // handlers
    modal.querySelector(".close-x").onclick = ()=> overlay.remove();
    modal.querySelector("#__nox_ok_btn").onclick = ()=> overlay.remove();

    // create canvas for fireworks inside wrapper
    const wrap = document.getElementById("__nox_fireworks_canvas_wrap");
    initFireworks(wrap);
  }

  // Fireworks implementation using canvas, particles and confetti
  function initFireworks(container){
    // cleanup existing canvases
    while(container.firstChild) container.removeChild(container.firstChild);

    const c = document.createElement("canvas");
    c.style.position = "absolute";
    c.style.left = "0";
    c.style.top = "0";
    c.width = container.clientWidth;
    c.height = container.clientHeight;
    container.appendChild(c);

    const ctx = c.getContext("2d");
    if (!ctx) return;

    let W = c.width;
    let H = c.height;

    function resize(){
      c.width = container.clientWidth;
      c.height = container.clientHeight;
      W = c.width; H = c.height;
    }
    window.addEventListener("resize", resize);

    // particle definitions
    class Particle {
      constructor(x,y, vx, vy, size, color, life, type){
        this.x=x; this.y=y; this.vx=vx; this.vy=vy; this.size=size; this.color=color; this.life=life; this.type=type||'spark';
        this.age = 0;
        this.rotation = Math.random()*360;
        this.spin = (Math.random()-0.5)*8;
      }
      update(dt){
        this.vy += 0.06; // gravity
        this.x += this.vx * dt;
        this.y += this.vy * dt;
        this.age += dt*16;
        this.rotation += this.spin * dt*40;
      }
      draw(ctx){
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.rotation * Math.PI/180);
        if (this.type==='spark') {
          ctx.fillStyle = this.color;
          const alpha = Math.max(0, 1 - this.age/this.life);
          ctx.globalAlpha = alpha;
          ctx.beginPath();
          ctx.arc(0,0, this.size,0,Math.PI*2);
          ctx.fill();
        } else {
          // confetti rectangle
          ctx.fillStyle = this.color;
          ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size*0.6);
        }
        ctx.restore();
      }
    }

    const colors = [
      '#ff3b30', '#ff9500', '#ffcc00', '#4cd964', '#32a7ff', '#5856d6', '#ff6bcb', '#ffd54f', '#8d6e63', '#f06292'
    ];

    const particles = [];
    let last = performance.now();
    let running = true;
    let autoBursts = 0;

    function spawnBurst(x,y, power=1.0){
      const count = 40 + Math.floor(120 * power);
      for(let i=0;i<count;i++){
        const angle = Math.random()*Math.PI*2;
        const speed = 2 + Math.random()*6 * power;
        const vx = Math.cos(angle) * speed;
        const vy = Math.sin(angle) * speed * 0.6;
        const size = 2 + Math.random()*5;
        const color = colors[Math.floor(Math.random()*colors.length)];
        const life = 800 + Math.random()*1200;
        particles.push(new Particle(x,y,vx,vy,size,color,life,'spark'));
      }
      // spawn some confetti
      for(let i=0;i<18;i++){
        const vx = (Math.random()-0.5)*6;
        const vy = -1 - Math.random()*6;
        const size = 6 + Math.random()*10;
        const color = colors[Math.floor(Math.random()*colors.length)];
        particles.push(new Particle(x,y,vx,vy,size,color,1200,'confetti'));
      }
    }

    function tick(now){
      const dt = Math.min(60, now-last)/16/2;
      last = now;

      ctx.clearRect(0,0,W,H);

      // subtle fade to create glow trails
      ctx.fillStyle = 'rgba(8,6,4,0.15)';
      ctx.fillRect(0,0,W,H);

      // update and draw particles
      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.update(dt);
        p.draw(ctx);
        if (p.age > p.life || p.y > H + 40) {
          particles.splice(i,1);
        }
      }

      // occasionally spawn automatic bursts
      if (running && particles.length < 80 && Math.random() < 0.03) {
        const px = 80 + Math.random()*(W-160);
        const py = 60 + Math.random()*(H*0.45);
        spawnBurst(px, py, 0.9 + Math.random()*1.4);
        autoBursts++;
      }

      if (running) requestAnimationFrame(tick);
    }

    // initial multi bursts for strong effect
    (function initialShow(){
      const cx = W/2;
      const cy = H*0.45;
      spawnBurst(cx, cy, 1.5);
      setTimeout(()=> spawnBurst(cx - 120, cy*0.7, 1.1), 120);
      setTimeout(()=> spawnBurst(cx + 120, cy*0.9, 1.2), 220);
      setTimeout(()=> spawnBurst(cx + 40, cy*0.6, 1.0), 360);
      // long tail of small bursts
      let i=0;
      const iv = setInterval(()=>{
        spawnBurst(80 + Math.random()*(W-160), 40 + Math.random()*H*0.5, 0.6 + Math.random()*0.8);
        i++;
        if (i>12) clearInterval(iv);
      }, 140);
    })();

    requestAnimationFrame(tick);

    // stop function to cleanup
    const stop = ()=>{
      running = false;
      window.removeEventListener("resize", resize);
      // remove canvas after a short fade
      setTimeout(()=> { if (c && c.parentNode) c.parentNode.removeChild(c); }, 600);
    };

    // auto stop after 6 seconds
    setTimeout(stop, 6500);
  }
</script>

</body>
</html>
